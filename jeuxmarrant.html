<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeux Marrants - STL Pocket</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-color: #1b1b1b;
            color: #fff;
            text-align: center;
        }

        h1 {
            color: #ffcc00;
            margin-top: 20px;
        }

        .menu {
            margin: 50px auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 300px;
        }

        .menu button, .back-button {
            padding: 15px;
            font-size: 18px;
            color: #fff;
            background-color: #007bff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .menu button:hover, .back-button:hover {
            background-color: #0056b3;
        }

        canvas {
            display: none;
            border: 2px solid #fff;
            margin: 20px auto;
        }

        #character-select {
            display: none;
        }

        #character-select img {
            width: 100px;
            height: auto;
            margin: 10px;
            cursor: pointer;
        }

        .back-button {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Jeux Marrants - STL Pocket</h1>

    <div class="menu">
        <button id="play-snake">Jouer à Snake</button>
        <button id="play-dbz">Jouer à Dragon Ball Xenoverse Lite</button>
    </div>

    <canvas id="snakeGame" width="400" height="400"></canvas>

    <div id="character-select">
        <h2>Choisissez votre personnage</h2>
        <div>
            <img src="images/goku.png" alt="Goku" data-character="Goku">
            <img src="images/vegeta.png" alt="Vegeta" data-character="Vegeta">
            <img src="images/freezer.png" alt="Freezer" data-character="Freezer">
            <img src="images/broly.png" alt="Broly" data-character="Broly">
        </div>
    </div>

    <canvas id="dbzGame" width="600" height="400"></canvas>
    <button class="back-button" id="back-to-menu">Retour au menu</button>

    <script>
        const menu = document.querySelector(".menu");
        const snakeGameCanvas = document.getElementById("snakeGame");
        const dbzGameCanvas = document.getElementById("dbzGame");
        const characterSelect = document.getElementById("character-select");
        const backToMenuButton = document.getElementById("back-to-menu");

        const ctxDBZ = dbzGameCanvas.getContext("2d");
        const characters = [
            { name: "Goku", color: "blue" },
            { name: "Vegeta", color: "green" },
            { name: "Freezer", color: "purple" },
            { name: "Broly", color: "red" }
        ];

        function showMenu() {
            menu.style.display = "flex";
            snakeGameCanvas.style.display = "none";
            dbzGameCanvas.style.display = "none";
            characterSelect.style.display = "none";
            backToMenuButton.style.display = "none";
        }

        backToMenuButton.addEventListener("click", showMenu);

        document.getElementById("play-snake").addEventListener("click", () => {
            menu.style.display = "none";
            snakeGameCanvas.style.display = "block";
            backToMenuButton.style.display = "block";
            startSnakeGame();
        });

        document.getElementById("play-dbz").addEventListener("click", () => {
            menu.style.display = "none";
            characterSelect.style.display = "block";
            backToMenuButton.style.display = "block";
        });

        document.querySelectorAll("#character-select img").forEach(img => {
            img.addEventListener("click", () => {
                const selectedCharacter = img.dataset.character;
                characterSelect.style.display = "none";
                dbzGameCanvas.style.display = "block";
                startDbzGame(selectedCharacter);
            });
        });

        function startSnakeGame() {
            // Contenu du jeu Snake déjà fourni
        }

        function startDbzGame(playerCharacter) {
            const player = { x: 300, y: 200, color: characters.find(c => c.name === playerCharacter).color, size: 20 };
            const enemies = characters
                .filter(c => c.name !== playerCharacter)
                .map((c, i) => ({ x: 100 + i * 100, y: 50, color: c.color, size: 20, dx: 2, dy: 2 }));

            function drawCharacter(character) {
                ctxDBZ.fillStyle = character.color;
                ctxDBZ.fillRect(character.x, character.y, character.size, character.size);
            }

            function moveEnemies() {
                enemies.forEach(enemy => {
                    enemy.x += enemy.dx;
                    enemy.y += enemy.dy;

                    if (enemy.x <= 0 || enemy.x >= dbzGameCanvas.width - enemy.size) enemy.dx *= -1;
                    if (enemy.y <= 0 || enemy.y >= dbzGameCanvas.height - enemy.size) enemy.dy *= -1;
                });
            }

            function detectCollision() {
                enemies.forEach(enemy => {
                    if (
                        player.x < enemy.x + enemy.size &&
                        player.x + player.size > enemy.x &&
                        player.y < enemy.y + enemy.size &&
                        player.y + player.size > enemy.y
                    ) {
                        alert("Vous avez été touché par un ennemi !");
                        showMenu();
                    }
                });
            }

            function update() {
                ctxDBZ.clearRect(0, 0, dbzGameCanvas.width, dbzGameCanvas.height);

                drawCharacter(player);
                enemies.forEach(drawCharacter);

                moveEnemies();
                detectCollision();

                requestAnimationFrame(update);
            }

            document.addEventListener("keydown", event => {
                if (event.key === "ArrowUp") player.y -= 10;
                if (event.key === "ArrowDown") player.y += 10;
                if (event.key === "ArrowLeft") player.x -= 10;
                if (event.key === "ArrowRight") player.x += 10;
            });

            update();
        }
    </script>
</body>
</html>
