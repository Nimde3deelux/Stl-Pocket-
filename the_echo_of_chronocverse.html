<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Echo of the Cronoverse</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Variables globales
        let scene, camera, renderer, player, sword;
        const enemies = [];

        // Fonction d'initialisation
        function init() {
            // Création de la scène
            scene = new THREE.Scene();

            // Création de la caméra
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 1.6, 3); // Position de la caméra à hauteur d'homme

            // Création du rendu
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Ajout d'une lumière ambiante
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);

            // Ajout d'une lumière directionnelle
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
            directionalLight.position.set(5, 10, 7.5);
            scene.add(directionalLight);

            // Création du terrain (forêt)
            const groundGeometry = new THREE.PlaneGeometry(100, 100);
            const groundMaterial = new THREE.MeshStandardMaterial({ color: 0x228B22 });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = - Math.PI / 2; // Rotation pour poser le sol
            scene.add(ground);

            // Ajouter des arbres (simple cubes pour le moment)
            for (let i = 0; i < 50; i++) {
                const treeGeometry = new THREE.CylinderGeometry(0.2, 0.5, 2, 8);
                const treeMaterial = new THREE.MeshStandardMaterial({ color: 0x8B4513 });
                const tree = new THREE.Mesh(treeGeometry, treeMaterial);
                tree.position.set(Math.random() * 100 - 50, 1, Math.random() * 100 - 50);
                scene.add(tree);
            }

            // Charger le modèle de Cosmorael
            const cosmoraelGeometry = new THREE.BoxGeometry(0.5, 1.5, 0.5); // Temporaire, à remplacer par un modèle 3D
            const cosmoraelMaterial = new THREE.MeshStandardMaterial({ color: 0xff5722 });
            player = new THREE.Mesh(cosmoraelGeometry, cosmoraelMaterial);
            player.position.set(0, 1, 0);
            scene.add(player);

            // Charger l'épée (simple boîte pour le moment)
            const swordGeometry = new THREE.BoxGeometry(0.1, 0.5, 0.1);
            const swordMaterial = new THREE.MeshStandardMaterial({ color: 0xFFD700 });
            sword = new THREE.Mesh(swordGeometry, swordMaterial);
            sword.position.set(0, 1.5, 0.25);
            player.add(sword);

            // Création des ennemis
            createEnemies(5); // Créer 5 ennemis

            // Écouteur d'événements pour les mouvements
            document.addEventListener('keydown', onKeyDown);
            window.addEventListener('resize', onWindowResize);

            animate(); // Démarre l'animation
        }

        // Fonction pour créer des ennemis
        function createEnemies(count) {
            for (let i = 0; i < count; i++) {
                const enemyGeometry = new THREE.BoxGeometry(0.5, 1, 0.5); // Temporaire, à remplacer par un modèle 3D
                const enemyMaterial = new THREE.MeshStandardMaterial({ color: 0xFF0000 });
                const enemy = new THREE.Mesh(enemyGeometry, enemyMaterial);
                enemy.position.set(Math.random() * 100 - 50, 0.5, Math.random() * 100 - 50);
                enemies.push(enemy);
                scene.add(enemy);
            }
        }

        // Fonction d'animation
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }

        // Gestion des mouvements du joueur
        function onKeyDown(event) {
            switch (event.key) {
                case 'ArrowUp':
                    player.position.z -= 0.1; // Avancer
                    break;
                case 'ArrowDown':
                    player.position.z += 0.1; // Reculer
                    break;
                case 'ArrowLeft':
                    player.position.x -= 0.1; // Aller à gauche
                    break;
                case 'ArrowRight':
                    player.position.x += 0.1; // Aller à droite
                    break;
                case ' ':
                    attack(); // Attaque avec l'épée
                    break;
            }
        }

        // Fonction d'attaque
        function attack() {
            // Logique pour l'attaque
            // Pour l'instant, juste une animation simple
            sword.position.z += 0.2;
            setTimeout(() => {
                sword.position.z -= 0.2; // Ramène l'épée
            }, 200);
        }

        // Fonction de redimensionnement de la fenêtre
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        init(); // Appel à la fonction d'initialisation
    </script>
</body>
</html>
